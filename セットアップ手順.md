# TikTok Re-Editor VOICEVOX - セットアップ手順

このアプリを使って、動画やテキストファイルから音声合成を行うことができます。

## 📋 必要なもの

### 1. ソフトウェア
- **Python 3.8以上** - [python.org](https://www.python.org/downloads/)からダウンロード
- **VOICEVOX** - [voicevox.hiroshiba.jp](https://voicevox.hiroshiba.jp/)からダウンロード

### 2. APIキー（無料）
- **Gladia API** - 文字起こし用
  - [gladia.io](https://www.gladia.io/)でアカウント作成
  - ダッシュボードからAPIキーを取得

- **Gemini API** - テキスト整形用
  - [ai.google.dev](https://ai.google.dev/)でアカウント作成
  - APIキーを取得（無料枠：1日20リクエスト）

---

## 🚀 セットアップ手順

### ステップ1: アプリファイルの準備

このフォルダ全体を好きな場所にコピーまたはダウンロードしてください。

フォルダ構成：
```
TikTok-Re-Editor-VOICEVOX/
├── app.py                    # メインアプリ
├── requirements.txt          # 必要なパッケージ一覧
├── .env.example             # 環境変数のサンプル
├── セットアップ手順.md      # このファイル
└── utils/                   # ユーティリティ
    ├── transcription.py
    ├── text_formatter.py
    └── voicevox.py
```

---

### ステップ2: Pythonのインストール確認

ターミナル（WindowsならコマンドプロンプトまたはPowerShell）を開いて、以下を実行：

```bash
python --version
```

または

```bash
python3 --version
```

**Python 3.8以上**と表示されればOK。表示されない場合は[python.org](https://www.python.org/downloads/)からインストールしてください。

---

### ステップ3: 必要なパッケージのインストール

ターミナルでこのフォルダに移動して、以下を実行：

```bash
cd /path/to/TikTok-Re-Editor-VOICEVOX
```

Windowsの場合：
```bash
pip install -r requirements.txt
```

Mac/Linuxの場合：
```bash
pip3 install -r requirements.txt
```

これで以下がインストールされます：
- streamlit（Webアプリフレームワーク）
- requests（API通信）
- python-dotenv（環境変数管理）
- google-generativeai（Gemini API）
- moviepy（動画処理）

---

### ステップ4: APIキーの設定

#### 4-1. `.env`ファイルの作成

`.env.example`ファイルをコピーして`.env`という名前に変更：

**Windowsの場合：**
```bash
copy .env.example .env
```

**Mac/Linuxの場合：**
```bash
cp .env.example .env
```

#### 4-2. APIキーの記入

`.env`ファイルをテキストエディタで開いて、取得したAPIキーを記入：

```env
# Gladia API Key
GLADIA_API_KEY=ここにGladiaのAPIキーを貼り付け

# Gemini API Key
GEMINI_API_KEY=ここにGeminiのAPIキーを貼り付け

# VOICEVOX API URL (通常は変更不要)
VOICEVOX_API_URL=http://localhost:50021
```

**例：**
```env
GLADIA_API_KEY=1234abcd-5678-efgh-9012-ijklmnopqrst
GEMINI_API_KEY=AIzaSyAbCdEfGhIjKlMnOpQrStUvWxYz1234567
VOICEVOX_API_URL=http://localhost:50021
```

⚠️ **重要：** APIキーは秘密情報です。他人と共有しないでください！

---

### ステップ5: VOICEVOXのインストールと起動

#### 5-1. VOICEVOXをダウンロード

[voicevox.hiroshiba.jp](https://voicevox.hiroshiba.jp/)から、お使いのOS版をダウンロードしてインストール。

#### 5-2. VOICEVOXを起動

VOICEVOXアプリを起動してください。

✅ アプリが起動して、通常通り使える状態にしてください。
✅ VOICEVOXは**起動したまま**にしておいてください（バックグラウンドで実行）。

---

### ステップ6: アプリの起動

ターミナルで以下のコマンドを実行：

**Windowsの場合：**
```bash
streamlit run app.py
```

**Mac/Linuxの場合：**
```bash
streamlit run app.py
```

成功すると、以下のようなメッセージが表示されます：

```
You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://192.168.x.x:8501
```

ブラウザが自動的に開いてアプリが表示されます。
開かない場合は、手動で `http://localhost:8501` にアクセスしてください。

---

## 📖 使い方

### 動画から音声生成

1. **「📹 動画から生成」タブ**を選択
2. 動画ファイル（mp4, mov, avi, mkv, webm）をアップロード
3. **「START」ボタン**をクリック
4. 自動的に以下が実行されます：
   - 文字起こし（Gladia API）
   - 14文字/行に整形（Gemini API）
   - ファイル名生成（Gemini API）
5. テキストを編集（必要に応じて）
6. VOICEVOXのキャラクターとスタイルを選択
7. 話速を調整
8. **「GENERATE」ボタン**で音声生成
9. テキストと音声をダウンロード

### テキストファイルから音声生成

1. **「📄 テキストから生成」タブ**を選択
2. テキストファイル（.txt）をアップロード
3. **「START」ボタン**をクリック
4. テキストがそのまま読み込まれます（整形なし）
5. テキストを編集（必要に応じて）
6. VOICEVOXのキャラクターとスタイルを選択
7. 話速を調整
8. **「GENERATE」ボタン**で音声生成
9. テキストと音声をダウンロード

---

## ⚠️ よくある問題と解決方法

### 問題1: `pip: command not found`

**原因:** Pythonが正しくインストールされていない

**解決方法:**
1. [python.org](https://www.python.org/downloads/)から最新版をダウンロード
2. インストール時に「Add Python to PATH」にチェックを入れる
3. インストール後、ターミナルを再起動

---

### 問題2: `streamlit: command not found`

**原因:** streamlitがインストールされていない

**解決方法:**
```bash
pip install streamlit
```

または

```bash
pip3 install streamlit
```

---

### 問題3: `⚠️ VOICEVOXに接続できません`

**原因:** VOICEVOXアプリが起動していない

**解決方法:**
1. VOICEVOXアプリを起動
2. アプリが完全に起動するまで待つ
3. ブラウザでアプリをリロード

---

### 問題4: `429 You exceeded your current quota` (Gemini API)

**原因:** Gemini APIの無料枠（1日20リクエスト）を超えた

**解決方法:**
1. **待つ:** 翌日（太平洋標準時の午前0時 = 日本時間17:00）まで待つ
2. **テキストタブを使う:** 「テキストから生成」タブは整形処理をスキップするのでAPIを使いません
3. **有料プランに変更:** より多くのリクエストが必要な場合

---

### 問題5: 文字化けする

**原因:** テキストファイルのエンコーディングがUTF-8でない

**解決方法:**
1. テキストファイルをUTF-8で保存し直す
2. メモ帳やテキストエディタで「名前を付けて保存」→「エンコーディング: UTF-8」を選択

---

## 🔐 セキュリティに関する注意

### APIキーの管理

- `.env`ファイルは**絶対に他人と共有しないでください**
- GitHubなどに公開する場合は、`.gitignore`に`.env`を追加してください
- APIキーが漏洩した場合は、すぐに無効化して新しいキーを発行してください

### ファイルの取り扱い

- アップロードした動画やテキストは、処理後にGladia/Geminiのサーバーに保存される場合があります
- 機密情報を含むファイルは使用しないでください

---

## 📞 サポート

### 公式ドキュメント

- **Streamlit:** [docs.streamlit.io](https://docs.streamlit.io/)
- **VOICEVOX:** [voicevox.hiroshiba.jp](https://voicevox.hiroshiba.jp/)
- **Gladia API:** [docs.gladia.io](https://docs.gladia.io/)
- **Gemini API:** [ai.google.dev/docs](https://ai.google.dev/docs)

---

## 🎉 完成！

これでセットアップは完了です。楽しんでください！

質問や問題があれば、このファイルの「よくある問題と解決方法」セクションを確認してください。
